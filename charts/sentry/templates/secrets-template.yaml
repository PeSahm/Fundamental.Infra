# =============================================================================
# Sentry Secrets
# =============================================================================
# These secrets should be created manually before deploying Sentry
# or via Ansible automation. This template serves as documentation.
# =============================================================================

# Main Sentry secrets
---
apiVersion: v1
kind: Secret
metadata:
  name: sentry-secrets
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "sentry.labels" . | nindent 4 }}
type: Opaque
# Data should be provided externally via:
# - Sealed Secrets
# - External Secrets Operator
# - Manual creation
# Required keys:
#   secret-key: 50+ character random string for Django secret key

---
# PostgreSQL credentials
apiVersion: v1
kind: Secret
metadata:
  name: sentry-postgresql
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "sentry.labels" . | nindent 4 }}
type: Opaque
# Required keys:
#   password: PostgreSQL password for sentry user

---
# Redis credentials
apiVersion: v1
kind: Secret
metadata:
  name: sentry-redis
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "sentry.labels" . | nindent 4 }}
type: Opaque
# Required keys:
#   password: Redis password

---
# Admin user credentials
apiVersion: v1
kind: Secret
metadata:
  name: sentry-admin
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "sentry.labels" . | nindent 4 }}
type: Opaque
# Required keys:
#   email: Admin user email
#   password: Admin user password

{{- if .Values.sentry.github.enabled }}
---
# GitHub App credentials
apiVersion: v1
kind: Secret
metadata:
  name: sentry-github
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "sentry.labels" . | nindent 4 }}
type: Opaque
# Required keys:
#   private-key: GitHub App private key (PEM format)
#   webhook-secret: GitHub webhook secret
#   client-secret: GitHub OAuth client secret
{{- end }}

{{- if .Values.sentry.mail.enabled }}
---
# Mail credentials
apiVersion: v1
kind: Secret
metadata:
  name: sentry-mail
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "sentry.labels" . | nindent 4 }}
type: Opaque
# Required keys:
#   password: SMTP password
{{- end }}
